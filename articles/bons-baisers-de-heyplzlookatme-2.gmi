---
title: "Bons baisers de heyplzlookatme #2"
date: 2023-09-04
authors:
  - LÃ©o
  - Tim
tags:
- bons-baisers
---

Si vous avez visitÃ© le site ces derniers jours, vous Ãªtes sÃ»rement tombÃ© des nues en voyant l'horrible page 502 de Nginx vous empÃªchant de lire les articles dont vous Ã©tiez impatient de dÃ©couvrir le contenu. Heureusement, vous Ãªtes des bons qui nous lisez Ã  l'origine sur Gemini, vous vous Ãªtes rendu compte que seul le proxy HTTP Ã©tait Ã  plat et vous avez poursuivi votre lecture sur Gemini ðŸ¥¸.

=> /banners/maintenance-h24.png La panne n'est dÃ©sormais qu'un lointain souvenir

## Philosophie de la misÃ¨re

La F.A.Q du projet Gemini a reÃ§u une mise Ã  jour de la part de solderpunk qui s'est visiblement rÃ©veillÃ© de son long sommeil. Elle est dÃ©sormais beaucoup plus axÃ©e sur l'aspect culturel du projet et sa philosophie plutÃ´t que sur la maniÃ¨re dont il est mis en Å“uvre techniquement.
Fort bien, me diriez-vous. Nonobstant la spec' technique est toujours autant Ã  chier et ambigÃ¼e sur plein de points, vous rÃ©pondrai-je.

=> gemini://gemini.circumlunar.space/docs/faq.gmi

## Se mettre bleu

Peut-Ãªtre que vous l'avez d'ores et dÃ©jÃ  remarquÃ© mais le proxy HTTP bÃ©nÃ©ficie maintenant de coloration syntaxique pour tous les langages supportÃ©s par Hilite, Ã  savoir OCaml et les fichiers dune, opam, shell et diff. Merci Ã  l'effort de ce bon Patrick Ferris qui nous permet de retirer l'ignoble script Javascript de Google, d'autant plus qu'il ne comprenait rien Ã  la syntaxe OCaml.

=> https://github.com/patricoferris/hilite/ Hilite

## Aussi sombres que nos cÅ“urs

Le style du site s'adapte maintenant au thÃ¨me de votre ordinateur (sur Mac et Firefox c'est mÃªme synchronisÃ© en temps rÃ©el) ! Un magnifique thÃ¨me sombre pluvieux contrastant Ã©lÃ©gamment avec le ciel nuageux du thÃ¨me clair s'acclimatera parfaitement Ã  vos visites nocturnes du site.
On comptait mÃªme tirer parti de la fonctionnalitÃ© Â« Feuille de style alternative Â» de Firefox pour que l'on puisse changer manuellement de thÃ¨me sur les ordis Ã©quipÃ©s d'un vieil OS mais j'ai ragÃ© et microbloggÃ© dans la foulÃ©e :

>Seigneur dieu c'est quoi l'intÃ©rÃªt des feuilles CSS alternatives (https://developer.mozilla.org/en-US/docs/Web/CSS/Alternative_style_sheets) si c'est fetch par le navigateur mÃªme lorsqu'elles ne sont pas appliquÃ©es ? Fuck cette merde

=> https://developer.mozilla.org/en-US/docs/Web/CSS/Alternative_style_sheets

## La seule vÃ©ritable science

=> /images/saine-lecture.png

## Plions bagages

On a changÃ© de serveur et mÃªme d'architecture.
Au lieu d'une petite VM x86 avec 1 cÅ“ur et 1Go de RAM, place au monstre ARM avec 4 cÅ“urs et 24Go de RAM !
Pourquoi ne pas avoir fait Ã§a avant ? Tout simplement parce que je n'avais aucune idÃ©e que j'y avais droit avec l'option Â« Always free Â» d'Oracle. On ne paie donc toujours rien mis Ã  part le nom de domaine.
Si l'on veut, on aura toujours accÃ¨s Ã  deux petites machines x86 gratuitement.

Quoi qu'il en soit, on va pouvoir redÃ©ployer le proxy et le serveur Gemini bien plus souvent puisqu'on peut enfin compiler directement lÃ -bas. Ã‡a m'Ã©vite donc de devoir demander Ã  Tim de compiler chez lui (il est sur Linux, pas moi, et on a la flemme de crosscompiler).

On a d'ailleurs trouvÃ© un bug dans Mehari en configurant les certificats TLS pour le nouveau serveur . En effet, on interprÃ¨te littÃ©ralement les _wildcard_ en faisant une simple comparaison :

```ocaml
let check_host uri epoch =
  match Uri.host uri with
  | None -> Error MissingHost
  | Some h -> (
      let hostnames = ... in
      (* Ã‰galitÃ© stricte au lieu de parser le nom de domaine *)
      match Seq.find (String.equal h) hostnames with
      | None -> Error WrongHost
      | Some _ -> Ok ())
```
=> https://github.com/Psi-Prod/Mehari/blob/f78102e89a78b0d71524b194ba0857efecdbddfd/mehari/protocol.ml#L60

Ainsi, configurer son certificat avec `*.heyplzlookat.me` en tant qu'_hostname_ et demander `new.heyplzlookat.me` renverra :

```
43 URL contains a foreign hostname
```

On corrigera ce problÃ¨me un de ces quatre.

## La documentationâ€¦

â€¦est de nouveau en ligne aprÃ¨s une longue absence dÃ»e Ã  notre flemme.

=> https://docs.heyplzlookat.me/
