---
title: "Bons baisers de heyplzlookatme #2"
date: 2023-09-04
authors:
  - L√©o
  - Tim
tags:
- bons-baisers
---

Si vous avez visit√© le site ces derniers jours, vous √™tes s√ªrement tomb√© des nues en voyant l'horrible page 502 de Nginx vous emp√™chant de lire les articles dont vous √©tiez impatient de d√©couvrir le contenu. Heureusement, vous √™tes des bons qui nous lisez √† l'origine sur Gemini, vous vous √™tes rendu compte que seul le proxy HTTP √©tait √† plat et vous avez poursuivi votre lecture sur Gemini ü•∏.

=> /banners/maintenance-h24.png La panne n'est d√©sormais qu'un lointain souvenir

## Philosophie de la mis√®re

La F.A.Q du projet Gemini a re√ßu une mise √† jour de la part de solderpunk qui s'est visiblement r√©veill√© de son long sommeil. Elle est d√©sormais beaucoup plus ax√©e sur l'aspect culturel du projet et sa philosophie plut√¥t que sur la mani√®re dont il est mis en ≈ìuvre techniquement.
Fort bien, me diriez-vous. Nonobstant la spec' technique est toujours autant √† chier et ambig√ºe sur plein de points, vous r√©pondrai-je.

=> gemini://gemini.circumlunar.space/docs/faq.gmi

## Se mettre bleu

Peut-√™tre que vous l'avez d'ores et d√©j√† remarqu√© mais le proxy HTTP b√©n√©ficie maintenant de coloration syntaxique pour tous les langages support√©s par Hilite, √† savoir OCaml et les fichiers dune, opam, shell et diff. Merci √† l'effort de ce bon Patrick Ferris qui nous permet de retirer l'ignoble script Javascript de Google, d'autant plus qu'il ne comprenait rien √† la syntaxe OCaml.

=> https://github.com/patricoferris/hilite/ Hilite

## Aussi sombres que nos c≈ìurs

Le style du site s'adapte maintenant au th√®me de votre ordinateur (sur Mac et Firefox c'est m√™me synchronis√© en temps r√©el) ! Un magnifique th√®me sombre pluvieux contrastant √©l√©gamment avec le ciel nuageux du th√®me clair s'acclimatera parfaitement √† vos visites nocturnes du site.
On comptait m√™me tirer parti de la fonctionnalit√© ¬´ Feuille de style alternative ¬ª de Firefox pour que l'on puisse changer manuellement de th√®me sur les ordis √©quip√©s d'un vieil OS mais j'ai rag√© et microblogg√© dans la foul√©e :

>Seigneur dieu c'est quoi l'int√©r√™t des feuilles CSS alternatives (https://developer.mozilla.org/en-US/docs/Web/CSS/Alternative_style_sheets) si c'est fetch par le navigateur m√™me lorsqu'elles ne sont pas appliqu√©es ? Fuck cette merde

=> https://developer.mozilla.org/en-US/docs/Web/CSS/Alternative_style_sheets

## La seule v√©ritable science

=> /images/saine-lecture.png

## Plions bagages

On a chang√© de serveur et m√™me d'architecture.
Au lieu d'une petite VM x86 avec 1 c≈ìur et 1Go de RAM, place au monstre ARM avec 4 c≈ìurs et 24Go de RAM !
Pourquoi ne pas avoir fait √ßa avant ? Tout simplement parce que je n'avais aucune id√©e que j'y avais droit avec l'option ¬´ Always free ¬ª d'Oracle. On ne paie donc toujours rien mis √† part le nom de domaine.
Si l'on veut, on aura toujours acc√®s √† deux petites machines x86 gratuitement.

Quoi qu'il en soit, on va pouvoir red√©ployer le proxy et le serveur Gemini bien plus souvent puisqu'on peut enfin compiler directement l√†-bas. √áa m'√©vite donc de devoir demander √† Tim de compiler chez lui (il est sur Linux, pas moi, et on a la flemme de crosscompiler).

On a d'ailleurs trouv√© un bug dans Mehari en configurant les certificats TLS pour le nouveau serveur . En effet, on interpr√®te litt√©ralement les _wildcard_ en faisant une simple comparaison :

```ocaml
let check_host uri epoch =
  match Uri.host uri with
  | None -> Error MissingHost
  | Some h -> (
      let hostnames = ... in
      (* √âgalit√© stricte au lieu de parser le nom de domaine *)
      match Seq.find (String.equal h) hostnames with
      | None -> Error WrongHost
      | Some _ -> Ok ())
```
=> https://github.com/Psi-Prod/Mehari/blob/f78102e89a78b0d71524b194ba0857efecdbddfd/mehari/protocol.ml#L60

Ainsi, configurer son certificat avec `*.heyplzlookat.me` en tant qu'_hostname_ et demander `new.heyplzlookat.me` renverra :

```
43 URL contains a foreign hostname
```

On corrigera ce probl√®me un de ces quatre.

## La documentation‚Ä¶

‚Ä¶est de nouveau en ligne apr√®s une longue absence d√ªe √† notre flemme.
